@inherits OrderEditBase

<div class="control-section">
    <div class="row">
        <div class="col-sm">
            <SfCard>
                <h3 class="space-margin">Factura nº @this.OrderId - Estado: @this.OrderViewModel.OrderStatus</h3>
            </SfCard>
        </div>
    </div>
    <div class="row">
        <div class="col-sm">
            <SfCard>
                <Condition Evaluation="@this.IsCancelled">
                    <NotMatch>
                        <div class="col-sm d-md-flex justify-content-md-end">
                            <SfCheckBox Label="Editar" @bind-Checked="@this.IsCustomerDataEditable" CssClass="space-margin"></SfCheckBox>
                        </div>
                    </NotMatch>
                </Condition>
                <EditForm class="control-section" Model="@this.OrderViewModel" OnValidSubmit="@this.EditClientDataAsync">
                    <CustomerInfo Item="@this.OrderViewModel.CustomerInfo" Enabled="@this.IsCustomerDataEditable" />
                    <Condition Evaluation="@this.IsCancelled">
                        <NotMatch>
                            <div class="col-sm d-md-flex justify-content-md-end">
                                <SfButton Type="submit" CssClass="e-success me-md-2" Disabled="!this.IsCustomerDataEditable">Actualizar</SfButton>
                            </div>
                        </NotMatch>
                    </Condition>
                </EditForm>
            </SfCard>
        </div>
        <div class="col-sm">
            <SfCard>
                <Condition Evaluation="@this.IsCancelled">
                    <NotMatch>
                        <div class="col-sm d-md-flex justify-content-md-end">
                            <SfCheckBox Label="Editar" @bind-Checked="@this.IsPaymentEditable" CssClass="space-margin"></SfCheckBox>
                        </div>
                    </NotMatch>
                </Condition>
                <EditForm class="control-section" Model="@this.OrderViewModel" OnValidSubmit="@this.EditPaymentAsync">
                    <Condition Evaluation="@this.ShowOrderItems">
                        <Match>
                            <Payments OrderViewModel="@this.OrderViewModel" Enabled="@this.IsPaymentEditable" />
                        </Match>
                    </Condition>
                    <Condition Evaluation="@this.IsCancelled">
                        <NotMatch>
                            <div class="col-sm d-md-flex justify-content-md-end">
                                <SfButton Type="submit" CssClass="e-success me-md-2" Disabled="!this.IsPaymentEditable">Actualizar</SfButton>
                            </div>
                        </NotMatch>
                    </Condition>
                </EditForm>
            </SfCard>
        </div>
    </div>
    <SfCard>
        <div class="row">
            <div class="col-sm">
                <div class="col-sm-12 col-lg-12 col-md-12">
                    <b class="spaccio-label">Productos</b>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm">
                <div class="space-margin">
                    <OrderSummary OrderDetails="@this.OrderViewModel.OrderDetail" />
                </div>
            </div>
        </div>
    </SfCard>
    <Condition Evaluation="@this.IsCancelled">
        <NotMatch>
            <SfCard>
                <div class="control-section">
                    <div class="row">
                        <div class="col-sm">
                            <div class="col-sm d-md-flex justify-content-md-end">
                                <SfButton Type="button" CssClass="e-danger me-md-2" OnClick="@this.ShowCancelOrderDialog">Cancelar</SfButton>
                            </div>
                        </div>
                    </div>
                </div>
            </SfCard>
        </NotMatch>
    </Condition>
</div>

<div id="target" class="col-lg-12 control-section">
    <SfDialog Width="400px" ShowCloseIcon="true" @bind-Visible="@this.ConfirmDialogVisibility" AllowPrerender="true" IsModal="true">
        <DialogTemplates>
            <Header> Confirmación</Header>
            <Content> ¿Estás seguro/a de que deseas cancelar la factura? </Content>
        </DialogTemplates>
        <DialogButtons>
            <DialogButton Content="Aceptar" IsPrimary="true" OnClick="@this.CancelOrderAsync" />
            <DialogButton Content="Cancelar" IsPrimary="false" OnClick="@(() => this.ConfirmDialogVisibility = false)" />
        </DialogButtons>
    </SfDialog>
</div>

<div class="col-lg-12 control-section">
    <SfToast ID="toast_order_edit" @ref="@this.ResultToast" Title="Result" Timeout="10000" Icon="e-meeting">
        <ToastPosition X="Center" />
        <ToastAnimationSettings>
            <ToastShowAnimationSettings Effect="ToastEffect.FadeZoomIn" />
            <ToastHideAnimationSettings Effect="ToastEffect.FadeZoomOut" />
        </ToastAnimationSettings>
    </SfToast>
</div>